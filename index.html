<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ò–º–ø—Ä–æ–≤–∏–∑–∞—Ç–æ—Ä–∞</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* Custom scrollbar hiding for horizontal lists */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        body {
            background-color: #111827; /* gray-900 */
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Icons (Inline Definitions to avoid CDN issues) ---
        const IconBase = ({ size = 24, className = "", children }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {children}
            </svg>
        );

        const Play = (props) => <IconBase {...props}><polygon points="5 3 19 12 5 21 5 3"></polygon></IconBase>;
        const Pause = (props) => <IconBase {...props}><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></IconBase>;
        const RefreshCw = (props) => <IconBase {...props}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M8 16H3v5"></path></IconBase>;
        const Zap = (props) => <IconBase {...props}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></IconBase>;
        const MapPin = (props) => <IconBase {...props}><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></IconBase>;
        const User = (props) => <IconBase {...props}><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></IconBase>;
        const Users = (props) => <IconBase {...props}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></IconBase>;
        const Target = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle></IconBase>;
        const ShieldAlert = (props) => <IconBase {...props}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></IconBase>;
        const ArrowRight = (props) => <IconBase {...props}><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></IconBase>;
        const AlertTriangle = (props) => <IconBase {...props}><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></IconBase>;
        const X = (props) => <IconBase {...props}><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></IconBase>;
        const Star = (props) => <IconBase {...props}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></IconBase>;

        // --- Helper for Difficulty Mapping ---
        const mapDiff = (d) => {
            const val = parseInt(d);
            if (val === 1) return 'easy';
            if (val === 2) return 'normal';
            if (val === 3) return 'hard';
            return 'normal';
        };

        // --- Data Dictionaries ---
        const DICTIONARY = {
            locations: [
                // --- HOME ---
                { text: "–ö—É—Ö–Ω—è –≤ –∫–æ–º–º—É–Ω–∞–ª–∫–µ", category: "home", difficulty: "easy" },
                { text: "–ö–≤–∞—Ä—Ç–∏—Ä–∞-—Å—Ç—É–¥–∏—è", category: "home", difficulty: "easy" },
                { text: "–ë–∞–ª–∫–æ–Ω —Å –≤–∏–¥–æ–º –Ω–∞ –¥–≤–æ—Ä", category: "home", difficulty: "easy" },
                { text: "–ü–æ–¥—ä–µ–∑–¥ —Å –∫–æ–Ω—Å—å–µ—Ä–∂–µ–º", category: "home", difficulty: "easy" },
                { text: "–õ–∏—Ñ—Ç", category: "home", difficulty: "easy" },
                { text: "–õ–µ—Å—Ç–Ω–∏—á–Ω–∞—è –ø–ª–æ—â–∞–¥–∫–∞", category: "home", difficulty: "easy" },
                { text: "–î–≤–æ—Ä —Å –¥–µ—Ç—Å–∫–æ–π –ø–ª–æ—â–∞–¥–∫–æ–π", category: "home", difficulty: "easy" },
                { text: "–ö–ª–∞–¥–æ–≤–∫–∞", category: "home", difficulty: "easy" },
                { text: "–ì–∞—Ä–∞–∂", category: "home", difficulty: "normal" },
                { text: "–ß–µ—Ä–¥–∞–∫", category: "home", difficulty: "normal" },
                { text: "–ü–æ–¥–≤–∞–ª", category: "home", difficulty: "normal" },
                // --- CITY ---
                { text: "–ü—É–Ω–∫—Ç –≤—ã–¥–∞—á–∏ –∑–∞–∫–∞–∑–æ–≤", category: "city", difficulty: "easy" },
                { text: "–ö–æ—Ñ–µ–π–Ω—è —É –º–µ—Ç—Ä–æ", category: "city", difficulty: "easy" },
                { text: "–ü–µ–∫–∞—Ä–Ω—è", category: "city", difficulty: "easy" },
                { text: "–ù–æ—á–Ω–æ–π –º–∞–≥–∞–∑–∏–Ω 24/7", category: "city", difficulty: "easy" },
                { text: "–ê–ø—Ç–µ–∫–∞", category: "city", difficulty: "easy" },
                { text: "–°—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏—è", category: "city", difficulty: "normal" },
                { text: "–ü–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∞", category: "city", difficulty: "normal" },
                { text: "–ú–§–¶", category: "city", difficulty: "normal" },
                { text: "–ü–æ—á—Ç–∞", category: "city", difficulty: "easy" },
                { text: "–¢–∞–∫—Å–∏", category: "city", difficulty: "easy" },
                { text: "–ú–µ—Ç—Ä–æ (–≤–∞–≥–æ–Ω)", category: "city", difficulty: "easy" },
                { text: "–ü–µ—Ä—Ä–æ–Ω –≤–æ–∫–∑–∞–ª–∞", category: "city", difficulty: "normal" },
                { text: "–ê—ç—Ä–æ–ø–æ—Ä—Ç (–≥–µ–π—Ç)", category: "city", difficulty: "normal" },
                { text: "–ü–∞—Ä–∫", category: "city", difficulty: "easy" },
                { text: "–ü–ª–æ—â–∞–¥–∫–∞ –¥–ª—è –≤—ã–≥—É–ª–∞ —Å–æ–±–∞–∫", category: "city", difficulty: "easy" },
                { text: "–§–∏—Ç–Ω–µ—Å-–∫–ª—É–±", category: "city", difficulty: "easy" },
                { text: "–°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã", category: "city", difficulty: "easy" },
                { text: "–ë–∞—Ä –≤ –ø—è—Ç–Ω–∏—Ü—É –≤–µ—á–µ—Ä–æ–º", category: "city", difficulty: "normal" },
                { text: "–†–µ—Å—Ç–æ—Ä–∞–Ω —Å –±–µ–ª—ã–º–∏ —Å–∫–∞—Ç–µ—Ä—Ç—è–º–∏", category: "city", difficulty: "normal" },
                // --- CULTURE ---
                { text: "–ö–∏–Ω–æ—Ç–µ–∞—Ç—Ä (—Ñ–æ–π–µ)", category: "culture", difficulty: "easy" },
                { text: "–¢–µ–∞—Ç—Ä (–∑–∞–∫—É–ª–∏—Å—å–µ)", category: "culture", difficulty: "normal" },
                { text: "–ú—É–∑–µ–π (–∑–∞–ª)", category: "culture", difficulty: "easy" },
                { text: "–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞", category: "culture", difficulty: "easy" },
                { text: "–ì—Ä–∏–º–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏–µ–º", category: "culture", difficulty: "normal" },
                { text: "–°—Ü–µ–Ω–∞ –∑–∞ –º–∏–Ω—É—Ç—É –¥–æ –≤—ã—Ö–æ–¥–∞", category: "culture", difficulty: "hard" },
                // --- WORK ---
                { text: "–ö–æ–≤–æ—Ä–∫–∏–Ω–≥", category: "work", difficulty: "easy" },
                { text: "–û—Ñ–∏—Å–Ω—ã–π –æ–ø–µ–Ω—Å–ø–µ–π—Å", category: "work", difficulty: "easy" },
                { text: "–ü–µ—Ä–µ–≥–æ–≤–æ—Ä–∫–∞", category: "work", difficulty: "normal" },
                { text: "–†–µ—Å–µ–ø—à–Ω –æ—Ñ–∏—Å–∞", category: "work", difficulty: "easy" },
                { text: "–ö–∞–±–∏–Ω–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞", category: "work", difficulty: "normal" },
                { text: "–ö—É—Ö–Ω—è –≤ –æ—Ñ–∏—Å–µ", category: "work", difficulty: "easy" },
                { text: "–ö–æ–ª–ª-—Ü–µ–Ω—Ç—Ä", category: "work", difficulty: "normal" },
                { text: "–°–∫–ª–∞–¥", category: "work", difficulty: "normal" },
                { text: "–î–æ—Å—Ç–∞–≤–∫–∞ —É –¥–≤–µ—Ä–∏ –∫–ª–∏–µ–Ω—Ç–∞", category: "work", difficulty: "easy" },
                { text: "–°—Ç—Ä–æ–π–∫–∞", category: "work", difficulty: "normal" },
                { text: "–£—á–∏—Ç–µ–ª—å—Å–∫–∞—è", category: "work", difficulty: "normal" },
                { text: "–ö–ª–∞—Å—Å", category: "work", difficulty: "easy" },
                { text: "–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—Å–∫–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è", category: "work", difficulty: "easy" },
                // --- NATURE ---
                { text: "–ü–ª—è–∂ –≤ –≤–µ—Ç—Ä–µ–Ω—ã–π –¥–µ–Ω—å", category: "nature", difficulty: "easy" },
                { text: "–õ–µ—Å–Ω–∞—è —Ç—Ä–æ–ø–∞", category: "nature", difficulty: "easy" },
                { text: "–ì–æ—Ä–Ω—ã–π –ø—Ä–∏—é—Ç", category: "nature", difficulty: "normal" },
                { text: "–ü–∞–ª–∞—Ç–∫–∞ –ø–æ–¥ –¥–æ–∂–¥—ë–º", category: "nature", difficulty: "normal" },
                // --- WEIRD ---
                { text: "–ü–æ–¥–≤–æ–¥–Ω–∞—è —Å—Ç–∞–Ω—Ü–∏—è", category: "weird", difficulty: "hard" },
                { text: "–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –∫–æ—Ä–∞–±–ª—å", category: "weird", difficulty: "hard" },
                { text: "–û—Ç–µ–ª—å –¥–ª—è –ø—Ä–∏–∑—Ä–∞–∫–æ–≤", category: "weird", difficulty: "hard" },
                { text: "–ú–∞–≥–∞–∑–∏–Ω –≤—Ä–µ–º–µ–Ω–∏", category: "weird", difficulty: "hard" },
                { text: "–ë–∞–Ω–∫ —ç–º–æ—Ü–∏–π", category: "weird", difficulty: "hard" },
                { text: "–¢–µ–∞—Ç—Ä, –≥–¥–µ –∑—Ä–∏—Ç–µ–ª–∏ —Ä–µ—à–∞—é—Ç —Å—É–¥—å–±—É –≥–µ—Ä–æ—è", category: "weird", difficulty: "hard" },
                { text: "–°—É–¥ –ø–æ –¥–µ–ª–∞–º —á—É–≤—Å—Ç–≤", category: "weird", difficulty: "hard" },
                { text: "–ì–æ—Ä–æ–¥ –±–µ–∑ –∑–≤—É–∫–æ–≤", category: "weird", difficulty: "hard" },
                { text: "–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è —Å–º–µ—Ö–∞", category: "weird", difficulty: "hard" },
                { text: "–ö–æ–º–Ω–∞—Ç–∞ –æ–∂–∏–¥–∞–Ω–∏—è ‚Äú–ø–æ—Å–ª–µ –∂–∏–∑–Ω–∏‚Äù", category: "weird", difficulty: "hard" }
            ],
            roles: [
                // --- CITY/SERVICE ---
                { text: "–ö—É—Ä—å–µ—Ä", difficulty: "easy" },
                { text: "–ö–∞—Å—Å–∏—Ä", difficulty: "easy" },
                { text: "–ë–∞—Ä–∏—Å—Ç–∞", difficulty: "easy" },
                { text: "–ü–æ–∫—É–ø–∞—Ç–µ–ª—å", difficulty: "easy" },
                { text: "–ö–ª–∏–µ–Ω—Ç VIP", difficulty: "normal" },
                { text: "–¢–∞–∫—Å–∏—Å—Ç", difficulty: "easy" },
                { text: "–ü–∞—Å—Å–∞–∂–∏—Ä –≤ —Ç–∞–∫—Å–∏", difficulty: "easy" },
                { text: "–ù–µ–∑–Ω–∞–∫–æ–º–µ—Ü –≤ –ª–∏—Ñ—Ç–µ", difficulty: "easy" },
                { text: "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Ä–µ—Å–µ–ø—à–Ω", difficulty: "easy" },
                { text: "–û—Ö—Ä–∞–Ω–Ω–∏–∫", difficulty: "normal" },
                { text: "–ü–æ–ª–∏—Ü–µ–π—Å–∫–∏–π", difficulty: "normal" },
                { text: "–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç", difficulty: "normal" },
                { text: "–ë–ª–æ–≥–µ—Ä", difficulty: "normal" },
                // --- WORK ---
                { text: "–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º", difficulty: "normal" },
                { text: "HR-–º–µ–Ω–µ–¥–∂–µ—Ä", difficulty: "normal" },
                { text: "–ü—Ä–æ–¥–∂–µ–∫—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä", difficulty: "normal" },
                { text: "–î–∏—Ä–µ–∫—Ç–æ—Ä", difficulty: "normal" },
                { text: "–°—Ç–∞–∂—ë—Ä", difficulty: "easy" },
                { text: "–Æ—Ä–∏—Å—Ç", difficulty: "normal" },
                { text: "–ë—É—Ö–≥–∞–ª—Ç–µ—Ä", difficulty: "normal" },
                { text: "–ú–∞—Ä–∫–µ—Ç–æ–ª–æ–≥", difficulty: "normal" },
                { text: "–î–∏–∑–∞–π–Ω–µ—Ä", difficulty: "normal" },
                { text: "–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç", difficulty: "normal" },
                { text: "–ö–æ–ª–ª–µ–≥–∞ ‚Äú—Å—Ç–∞—Ä–æ–∂–∏–ª‚Äù", difficulty: "normal" },
                // --- EDUCATION ---
                { text: "–£—á–∏—Ç–µ–ª—å", difficulty: "easy" },
                { text: "–°—Ç—É–¥–µ–Ω—Ç", difficulty: "easy" },
                { text: "–¢—Ä–µ–Ω–µ—Ä", difficulty: "normal" },
                { text: "–≠–∫–∑–∞–º–µ–Ω–∞—Ç–æ—Ä", difficulty: "normal" },
                // --- SCENE ---
                { text: "–ê–∫—Ç—ë—Ä", difficulty: "normal" },
                { text: "–†–µ–∂–∏—Å—Å—ë—Ä", difficulty: "normal" },
                { text: "–ú—É–∑—ã–∫–∞–Ω—Ç", difficulty: "normal" },
                { text: "–í–µ–¥—É—â–∏–π –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è", difficulty: "normal" },
                { text: "–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä", difficulty: "normal" },
                // --- HOME ---
                { text: "–°–æ—Å–µ–¥(–∫–∞)", difficulty: "easy" },
                { text: "–†–æ–¥–∏—Ç–µ–ª—å", difficulty: "easy" },
                { text: "–ü–æ–¥—Ä–æ—Å—Ç–æ–∫", difficulty: "easy" },
                { text: "–ü–∞—Ä—Ç–Ω—ë—Ä –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º", difficulty: "easy" },
                { text: "–õ—É—á—à–∏–π –¥—Ä—É–≥", difficulty: "easy" },
                // --- WEIRD ---
                { text: "–ü—Ä–∏–∑—Ä–∞–∫", difficulty: "hard" },
                { text: "–†–æ–±–æ—Ç-–ø–æ–º–æ—â–Ω–∏–∫", difficulty: "hard" },
                { text: "–ò–Ω–æ–ø–ª–∞–Ω–µ—Ç—è–Ω–∏–Ω", difficulty: "hard" },
                { text: "–£—á—ë–Ω—ã–π", difficulty: "hard" },
                { text: "–ü—Ä–æ–¥–∞–≤–µ—Ü –≤—Ä–µ–º–µ–Ω–∏", difficulty: "hard" },
                { text: "–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä —ç–º–æ—Ü–∏–π", difficulty: "hard" }
            ],
            traits: [
                { text: "–£–≤–µ—Ä–µ–Ω–Ω—ã–π", type: "status", difficulty: "easy" },
                { text: "–ó–∞–∂–∞—Ç—ã–π", type: "status", difficulty: "easy" },
                { text: "–ü–∞—Ñ–æ—Å–Ω—ã–π", type: "status", difficulty: "easy" },
                { text: "–ù–µ–∑–∞–º–µ—Ç–Ω—ã–π", type: "status", difficulty: "easy" },
                { text: "–í–ª–∞—Å—Ç–Ω—ã–π", type: "status", difficulty: "normal" },
                { text: "–£—Å–ª—É–∂–ª–∏–≤—ã–π", type: "status", difficulty: "easy" },
                { text: "–ü—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω—ã–π", type: "status", difficulty: "normal" },
                { text: "–•–∏—Ç—Ä—ã–π", type: "status", difficulty: "normal" },
                { text: "–ù–∞–∏–≤–Ω—ã–π", type: "status", difficulty: "easy" },
                { text: "–û–±–∏–¥—á–∏–≤—ã–π", type: "emotion", difficulty: "easy" },
                { text: "–†–µ–≤–Ω–∏–≤—ã–π", type: "emotion", difficulty: "normal" },
                { text: "–°–ø–æ–∫–æ–π–Ω—ã–π", type: "emotion", difficulty: "easy" },
                { text: "–ü–∞–Ω–∏–∫—ë—Ä", type: "emotion", difficulty: "normal" },
                { text: "–°–≤–µ—Ä—Ö–≤–µ—Å—ë–ª—ã–π", type: "emotion", difficulty: "normal" },
                { text: "–ú—Ä–∞—á–Ω—ã–π", type: "emotion", difficulty: "easy" },
                { text: "–°–∞—Ä–∫–∞—Å—Ç–∏—á–Ω—ã–π", type: "quirk", difficulty: "normal" },
                { text: "–ß–µ—Ä–µ—Å—á—É—Ä —á–µ—Å—Ç–Ω—ã–π", type: "quirk", difficulty: "normal" },
                { text: "–í—Å–µ–≥–¥–∞ —à–µ–ø—á–µ—Ç", type: "quirk", difficulty: "normal" },
                { text: "–ì–æ–≤–æ—Ä–∏—Ç —Ç–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–∞–º–∏", type: "quirk", difficulty: "hard" },
                { text: "–ù–µ –º–æ–∂–µ—Ç —Å–∫–∞–∑–∞—Ç—å ‚Äú–Ω–µ—Ç‚Äù", type: "quirk", difficulty: "normal" },
                { text: "–ü–æ—Å—Ç–æ—è–Ω–Ω–æ –æ–ø—Ä–∞–≤–¥—ã–≤–∞–µ—Ç—Å—è", type: "quirk", difficulty: "normal" },
                { text: "–°—á–∏—Ç–∞–µ—Ç —Å–µ–±—è –≥–µ–Ω–∏–µ–º", type: "status", difficulty: "normal" },
                { text: "–°—á–∏—Ç–∞–µ—Ç —Å–µ–±—è —Å–∞–º–æ–∑–≤–∞–Ω—Ü–µ–º", type: "status", difficulty: "normal" },
                { text: "–ì–æ–≤–æ—Ä–∏—Ç –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ", type: "quirk", difficulty: "normal" },
                { text: "–ì–æ–≤–æ—Ä–∏—Ç —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ", type: "quirk", difficulty: "normal" },
                { text: "–°–º–µ—ë—Ç—Å—è –Ω–µ –∫ –º–µ—Å—Ç—É", type: "quirk", difficulty: "normal" },
                { text: "–ü—É—Ç–∞–µ—Ç —Å–ª–æ–≤–∞", type: "quirk", difficulty: "normal" },
                { text: "–ù–µ –≤—ã–Ω–æ—Å–∏—Ç —Ç–∏—à–∏–Ω—É", type: "quirk", difficulty: "normal" },
                { text: "–ë–æ–∏—Ç—Å—è –ø—Ä–∞–≤–∏–ª", type: "emotion", difficulty: "normal" },
                { text: "–û–±–æ–∂–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–∞", type: "status", difficulty: "normal" },
                { text: "–°—á–∏—Ç–∞–µ—Ç, —á—Ç–æ –≤–æ–∫—Ä—É–≥ –∑–∞–≥–æ–≤–æ—Ä", type: "emotion", difficulty: "hard" },
                { text: "–°–∫—Ä—ã–≤–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç", type: "quirk", difficulty: "normal" },
                { text: "–ü—ã—Ç–∞–µ—Ç—Å—è –ø–æ–Ω—Ä–∞–≤–∏—Ç—å—Å—è –≤—Å–µ–º", type: "status", difficulty: "normal" },
                { text: "–ü–æ—Å—Ç–æ—è–Ω–Ω–æ —Ç–æ—Ä–≥—É–µ—Ç—Å—è", type: "quirk", difficulty: "normal" },
                { text: "–í–µ—á–Ω–æ –æ–ø–∞–∑–¥—ã–≤–∞–µ—Ç", type: "quirk", difficulty: "normal" },
                { text: "–°–ª–∏—à–∫–æ–º –ø—É–Ω–∫—Ç—É–∞–ª–µ–Ω", type: "quirk", difficulty: "normal" },
                { text: "–í–µ—á–Ω–æ —É—á–∏—Ç –∂–∏–∑–Ω–∏", type: "status", difficulty: "normal" },
                { text: "–ì–æ–≤–æ—Ä–∏—Ç –º–µ—Ç–∞—Ñ–æ—Ä–∞–º–∏", type: "quirk", difficulty: "normal" },
                { text: "–í–µ–¥—ë—Ç —Å–µ–±—è –∫–∞–∫ –≤ –∫–∏–Ω–æ", type: "quirk", difficulty: "normal" },
                { text: "–°–ª–∏—à–∫–æ–º –≤–µ–∂–ª–∏–≤—ã–π", type: "status", difficulty: "easy" },
                { text: "–ì—Ä—É–±–∏—Ç –∏–∑ —Å—Ç—Ä–∞—Ö–∞", type: "emotion", difficulty: "normal" },
                { text: "–°–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª—ë–∑—ã", type: "emotion", difficulty: "normal" },
                { text: "–ò—â–µ—Ç –æ–¥–æ–±—Ä–µ–Ω–∏–µ", type: "status", difficulty: "normal" },
                { text: "–ù–∏–∫–æ–º—É –Ω–µ –¥–æ–≤–µ—Ä—è–µ—Ç", type: "emotion", difficulty: "normal" },
                { text: "–°—Ä–∞–∑—É –¥–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ–º", type: "emotion", difficulty: "normal" },
                { text: "–°—á–∏—Ç–∞–µ—Ç –¥–µ–Ω—å–≥–∏ –≤ –≥–æ–ª–æ–≤–µ", type: "quirk", difficulty: "normal" },
                { text: "–î–µ—Ä–∂–∏—Ç –ª–∏—Ü–æ –ª—é–±–æ–π —Ü–µ–Ω–æ–π", type: "status", difficulty: "normal" },
                { text: "–ù–µ —É–º–µ–µ—Ç –≤—Ä–∞—Ç—å", type: "quirk", difficulty: "normal" },
                { text: "–í—Ä—ë—Ç –ª–µ–≥–∫–æ –∏ –∫—Ä–∞—Å–∏–≤–æ", type: "quirk", difficulty: "hard" },
                { text: "–°—Ç–∞–≤–∏—Ç –¥–∏–∞–≥–Ω–æ–∑—ã –≤—Å–µ–º –≤–æ–∫—Ä—É–≥", type: "quirk", difficulty: "normal" },
                { text: "–°–ª—ã—à–∏—Ç ‚Äú–Ω–µ —Ç–æ‚Äù", type: "quirk", difficulty: "normal" },
                { text: "–û—Ç–≤–µ—á–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –ø—Ä—è–º–æ", type: "quirk", difficulty: "normal" },
                { text: "–ò–∑–≤–∏–Ω—è–µ—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ", type: "quirk", difficulty: "normal" },
                { text: "–ì–æ–≤–æ—Ä–∏—Ç ‚Äú–º—ã‚Äù –≤–º–µ—Å—Ç–æ ‚Äú—è‚Äù", type: "quirk", difficulty: "normal" },
                { text: "–°—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –º–µ–ª–æ—á–∞—Ö", type: "emotion", difficulty: "normal" },
                { text: "–°–ª–∏—à–∫–æ–º —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω", type: "emotion", difficulty: "easy" },
                { text: "–°–ª–∏—à–∫–æ–º –Ω–∞–ø—Ä—è–∂—ë–Ω", type: "emotion", difficulty: "easy" }
            ],
            goalsSingle: [
                { text: "–£–±–µ–¥–∏—Ç—å –¥—Ä—É–≥–æ–≥–æ –æ—Å—Ç–∞—Ç—å—Å—è –µ—â—ë –Ω–∞ 5 –º–∏–Ω—É—Ç", difficulty: "easy" },
                { text: "–£–±–µ–¥–∏—Ç—å –¥—Ä—É–≥–æ–≥–æ —É–π—Ç–∏ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å", difficulty: "easy" },
                { text: "–ü–æ–ø—Ä–æ—Å–∏—Ç—å —É—Å–ª—É–≥—É, –Ω–µ —É–Ω–∏–∑–∏–≤—à–∏—Å—å", difficulty: "easy" },
                { text: "–û—Ç–∫–∞–∑–∞—Ç—å –∏ –Ω–µ –ø–æ—Å—Å–æ—Ä–∏—Ç—å—Å—è", difficulty: "easy" },
                { text: "–ò–∑–≤–∏–Ω–∏—Ç—å—Å—è —Ç–∞–∫, —á—Ç–æ–±—ã —Ç–µ–±–µ –ø–æ–≤–µ—Ä–∏–ª–∏", difficulty: "easy" },
                { text: "–°–∫—Ä—ã—Ç—å, —á—Ç–æ —Ç—ã –≤–∏–Ω–æ–≤–∞—Ç(–∞)", difficulty: "normal" },
                { text: "–í—ã–≤–µ—Å—Ç–∏ –¥—Ä—É–≥–æ–≥–æ –Ω–∞ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ", difficulty: "normal" },
                { text: "–ü—Ä–æ–¥–∞—Ç—å –∏–¥–µ—é/–ø—Ä–æ–µ–∫—Ç –∑–∞ 1 –º–∏–Ω—É—Ç—É", difficulty: "normal" },
                { text: "–í—ã–±–∏—Ç—å —Å–∫–∏–¥–∫—É, –Ω–µ –≤—ã–≥–ª—è–¥—è –∂–∞–¥–Ω—ã–º", difficulty: "easy" },
                { text: "–ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø/–ø—Ä–æ–ø—É—Å–∫/—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ", difficulty: "easy" },
                { text: "–í–µ—Ä–Ω—É—Ç—å –¥–æ–ª–≥, –Ω–µ —Ä–∞–∑—Ä—É—à–∏–≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è", difficulty: "normal" },
                { text: "–ü–æ–ø—Ä–æ—Å–∏—Ç—å –≤ –¥–æ–ª–≥, —Å–æ—Ö—Ä–∞–Ω–∏–≤ —Å—Ç–∞—Ç—É—Å", difficulty: "normal" },
                { text: "–î–æ–≥–æ–≤–æ—Ä–∏—Ç—å—Å—è –æ –ø–µ—Ä–µ–Ω–æ—Å–µ —Å—Ä–æ–∫–∞", difficulty: "normal" },
                { text: "–°–∫—Ä—ã—Ç—å, —á—Ç–æ —Ç—ã –Ω–∏—á–µ–≥–æ –Ω–µ —Å–¥–µ–ª–∞–ª(–∞)", difficulty: "normal" },
                { text: "–£—Å–ø–æ–∫–æ–∏—Ç—å —á–µ–ª–æ–≤–µ–∫–∞ –≤ –ø–∞–Ω–∏–∫–µ", difficulty: "normal" },
                { text: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–∏—Ü–æ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏", difficulty: "normal" },
                { text: "–î–æ–±–∏—Ç—å—Å—è –ø—Ä–∏–∑–Ω–∞–Ω–∏—è –∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–∞", difficulty: "hard" },
                { text: "–ù–µ –¥–∞—Ç—å –≤—Ç—è–Ω—É—Ç—å —Å–µ–±—è –≤ —á—É–∂—É—é –¥—Ä–∞–º—É", difficulty: "normal" },
                { text: "–í—ã—è—Å–Ω–∏—Ç—å ‚Äú—á—Ç–æ –º–µ–∂–¥—É –Ω–∞–º–∏‚Äù", difficulty: "normal" },
                { text: "–û—Ç—Å—Ç–æ—è—Ç—å –≤–æ–∑–≤—Ä–∞—Ç/–∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é", difficulty: "normal" },
                { text: "–í—ã–Ω—É–¥–∏—Ç—å –¥—Ä—É–≥–æ–≥–æ –Ω–∞–∑–≤–∞—Ç—å —Ü–µ–Ω—É –ø–µ—Ä–≤—ã–º", difficulty: "hard" }
            ],
            goalsPairs: [
                { a: "–£–±–µ–¥–∏—Ç—å –ø–æ–¥–ø–∏—Å–∞—Ç—å –¥–æ–≥–æ–≤–æ—Ä", b: "–ù–µ –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å –±–µ–∑ –≥–∞—Ä–∞–Ω—Ç–∏–π", difficulty: "normal" },
                { a: "–ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å", b: "–°–æ–±–ª—é—Å—Ç–∏ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç –∏ –Ω–µ –ø—É—Å—Ç–∏—Ç—å", difficulty: "normal" },
                { a: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–∏—Ü–æ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏", b: "–ü—É–±–ª–∏—á–Ω–æ —É–∫–∞–∑–∞—Ç—å –Ω–∞ –æ—à–∏–±–∫—É", difficulty: "normal" },
                { a: "–ü–æ–ø—Ä–æ—Å–∏—Ç—å –≤ –¥–æ–ª–≥", b: "–û—Ç–∫–∞–∑–∞—Ç—å –∏ –Ω–µ –≤—ã–≥–ª—è–¥–µ—Ç—å –∂–∞–¥–Ω—ã–º", difficulty: "normal" },
                { a: "–£–±–µ–¥–∏—Ç—å –æ—Å—Ç–∞—Ç—å—Å—è", b: "–£–π—Ç–∏ –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ", difficulty: "easy" },
                { a: "–°–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–¥—É", b: "–°–∫—Ä—ã—Ç—å –ø—Ä–∞–≤–¥—É —Ä–∞–¥–∏ –≤—ã–≥–æ–¥—ã", difficulty: "hard" },
                { a: "–ü—Ä–æ–¥–∞—Ç—å –∏–¥–µ—é", b: "–†–∞–∑–Ω–µ—Å—Ç–∏ –∏–¥–µ—é –∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å", difficulty: "normal" },
                { a: "–î–æ–±–∏—Ç—å—Å—è –ø—Ä–∏–∑–Ω–∞–Ω–∏—è", b: "–ù–µ –ø—Ä–∏–∑–Ω–∞—Ç—å—Å—è –Ω–∏ –ø—Ä–∏ –∫–∞–∫–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö", difficulty: "normal" },
                { a: "–£—Å–ø–æ–∫–æ–∏—Ç—å", b: "‚Äú–í—Å—Ç—Ä—è—Ö–Ω—É—Ç—å‚Äù –∏ –Ω–∞–¥–∞–≤–∏—Ç—å", difficulty: "normal" },
                { a: "–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å—Ä–æ–∫–∏", b: "–î–∞–≤–∏—Ç—å –∏ –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å", difficulty: "normal" },
                { a: "–£–≥–æ–≤–æ—Ä–∏—Ç—å –Ω–∞ —Ä–∏—Å–∫", b: "–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –∑–∞—â–∏—Ç–∏—Ç—å", difficulty: "normal" },
                { a: "–í—ã—è—Å–Ω–∏—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏—è", b: "–°–≤–µ—Å—Ç–∏ –≤—Å—ë –∫ —à—É—Ç–∫–µ –∏ —É–π—Ç–∏", difficulty: "normal" },
                { a: "–ü–æ–ª—É—á–∏—Ç—å —Å–∫–∏–¥–∫—É", b: "–ù–µ –¥–∞–≤–∞—Ç—å —Å–∫–∏–¥–∫—É –∏–∑ –ø—Ä–∏–Ω—Ü–∏–ø–∞", difficulty: "normal" },
                { a: "–°—Ç–∞—Ç—å ‚Äú—Å–≤–æ–∏–º‚Äù", b: "–ü—Ä–æ–≤–µ—Ä—è—Ç—å –∏ –Ω–µ –¥–æ–≤–µ—Ä—è—Ç—å", difficulty: "normal" },
                { a: "–ü–æ–ø—Ä–æ—Å–∏—Ç—å –ø–æ–≤—ã—à–µ–Ω–∏—è", b: "–°—ç–∫–æ–Ω–æ–º–∏—Ç—å –±—é–¥–∂–µ—Ç –ª—é–±–æ–π —Ü–µ–Ω–æ–π", difficulty: "normal" }
            ],
            goalsShared: [
                { goal: "–£—Å–ø–µ—Ç—å –Ω–∞ –ø–æ–µ–∑–¥/—Å–∞–º–æ–ª—ë—Ç", obstacle: "–æ–¥–∏–Ω –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ—Ç–≤–ª–µ–∫–∞–µ—Ç—Å—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞–º–∏", difficulty: "normal" },
                { goal: "–°–∫—Ä—ã—Ç—å –ø—Ä–æ–±–ª–µ–º—É –æ—Ç —Ç—Ä–µ—Ç—å–µ–≥–æ –ª–∏—Ü–∞", obstacle: "—Ç—Ä–µ—Ç—å–µ –ª–∏—Ü–æ –≤–æ—Ç-–≤–æ—Ç –≤–æ–π–¥—ë—Ç", difficulty: "normal" },
                { goal: "–°—Ä–æ—á–Ω–æ –Ω–∞–π—Ç–∏ –ø—Ä–æ–ø–∞–≤—à—É—é –≤–µ—â—å", obstacle: "–Ω–∏–∫—Ç–æ –Ω–µ –ø—Ä–∏–∑–Ω–∞—ë—Ç—Å—è, –∫—Ç–æ –±—Ä–∞–ª", difficulty: "normal" },
                { goal: "–û—Ç—Ä–µ–ø–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏–µ", obstacle: "–≤—Ä–µ–º–µ–Ω–∏ –ø–æ—á—Ç–∏ –Ω–µ—Ç, –≤—Å–µ –Ω–µ—Ä–≤–Ω–∏—á–∞—é—Ç", difficulty: "normal" },
                { goal: "–°–ø–∞—Å—Ç–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ –æ—Ç –ø—Ä–æ–≤–∞–ª–∞", obstacle: "–æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä –≤ –ø–∞–Ω–∏–∫–µ –∏ –æ–±–≤–∏–Ω—è–µ—Ç –≤—Å–µ—Ö", difficulty: "normal" },
                { goal: "–î–æ–≥–æ–≤–æ—Ä–∏—Ç—å—Å—è –æ –ø—Ä–∞–≤–∏–ª–∞—Ö", obstacle: "–æ–±–∞ –±–æ—è—Ç—Å—è –ø–æ—Ç–µ—Ä—è—Ç—å —Å–≤–æ–±–æ–¥—É", difficulty: "normal" },
                { goal: "–ü—Ä–æ–≤–µ—Å—Ç–∏ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã", obstacle: "—Å–∫–µ–ø—Ç–∏–∫ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ–±–∏–≤–∞–µ—Ç", difficulty: "normal" },
                { goal: "–î–æ–π—Ç–∏ –¥–æ –ø—É–Ω–∫—Ç–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è", obstacle: "–Ω–∞–≤–∏–≥–∞—Ü–∏—è —Å–ª–æ–º–∞–ª–∞—Å—å, —Å–ø–æ—Ä –æ –º–∞—Ä—à—Ä—É—Ç–µ", difficulty: "normal" }
            ],
            crazyOptions: [
                // --- SPEECH ---
                { text: "–ö–∞–∂–¥–∞—è —Ñ—Ä–∞–∑–∞ ‚Äî –≤–æ–ø—Ä–æ—Å", type: "speech", difficulty: "normal" },
                { text: "–ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–æ–≤–æ ‚Äú—è‚Äù", type: "speech", difficulty: "hard" },
                { text: "–ù–µ–ª—å–∑—è –≥–æ–≤–æ—Ä–∏—Ç—å ‚Äú–Ω–µ—Ç‚Äù", type: "speech", difficulty: "hard" },
                { text: "–ì–æ–≤–æ—Ä–∏—à—å —Ç–æ–ª—å–∫–æ —à—ë–ø–æ—Ç–æ–º", type: "speech", difficulty: "normal" },
                { text: "–ì–æ–≤–æ—Ä–∏—à—å —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ, –∫–∞–∫ —Ä–æ–±–æ—Ç", type: "speech", difficulty: "hard" },
                { text: "–í –∫–∞–∂–¥–æ–π —Ñ—Ä–∞–∑–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç", type: "speech", difficulty: "normal" },
                { text: "–í –∫–∞–∂–¥–æ–π —Ñ—Ä–∞–∑–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –æ—Ç–∫–∞–∑ (–Ω–æ –º—è–≥–∫–∏–π)", type: "speech", difficulty: "hard" },
                { text: "–ì–æ–≤–æ—Ä–∏—à—å —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞—Ñ–æ—Ä–∞–º–∏ (‚Äú—ç—Ç–æ –∫–∞–∫‚Ä¶‚Äù)", type: "speech", difficulty: "hard" },
                // --- PHYSICAL ---
                { text: "–ù–µ–ª—å–∑—è —Å—Ç–æ—è—Ç—å –Ω–∞ –º–µ—Å—Ç–µ (–≤—Å—ë –≤—Ä–µ–º—è –≤ –¥–≤–∏–∂–µ–Ω–∏–∏)", type: "physical", difficulty: "normal" },
                { text: "–¢—ã –¥–µ—Ä–∂–∏—à—å –≤–æ–æ–±—Ä–∞–∂–∞–µ–º—ã–π —Ç—è–∂—ë–ª—ã–π –ø—Ä–µ–¥–º–µ—Ç", type: "physical", difficulty: "normal" },
                { text: "–¢—ã –≤—Å—ë –≤—Ä–µ–º—è –ø—ã—Ç–∞–µ—à—å—Å—è –∑–∞–Ω—è—Ç—å ‚Äú—á—É–∂–æ–µ‚Äù –º–µ—Å—Ç–æ", type: "physical", difficulty: "normal" },
                { text: "–¢—ã –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–æ–ø—Ä–∞–≤–ª—è–µ—à—å –Ω–µ–≤–∏–¥–∏–º—É—é –æ–¥–µ–∂–¥—É", type: "physical", difficulty: "easy" },
                { text: "–¢—ã –Ω–µ –º–æ–∂–µ—à—å —Å–º–æ—Ç—Ä–µ—Ç—å –≤ –≥–ª–∞–∑–∞", type: "physical", difficulty: "normal" },
                { text: "–¢—ã ‚Äú—Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ‚Äù –ø–æ–¥—Ö–æ–¥–∏—à—å (–Ω–∞—Ä—É—à–∞–µ—à—å –¥–∏—Å—Ç–∞–Ω—Ü–∏—é)", type: "physical", difficulty: "normal" },
                // --- EMOTIONAL ---
                { text: "–¢—ã –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ –∏ –Ω–µ –º–æ–∂–µ—à—å —Å–∫—Ä—ã—Ç—å —Ä–∞–¥–æ—Å—Ç—å", type: "emotion", difficulty: "easy" },
                { text: "–¢—ã –≤ –ø–∞–Ω–∏–∫–µ, –Ω–æ –ø—ã—Ç–∞–µ—à—å—Å—è –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ø–æ–∫–æ–π–Ω—ã–º", type: "emotion", difficulty: "normal" },
                { text: "–¢—ã —Å–º–µ—Ä—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–ª, –Ω–æ –¥–µ—Ä–∂–∏—à—å –ª–∏—Ü–æ", type: "emotion", difficulty: "normal" },
                { text: "–¢—ã –ø–æ–¥–æ–∑—Ä–µ–≤–∞–µ—à—å –∑–∞–≥–æ–≤–æ—Ä", type: "emotion", difficulty: "hard" },
                { text: "–¢—ã –≤–ª—é–±–ª—ë–Ω –∏ —Å–∫—Ä—ã–≤–∞–µ—à—å —ç—Ç–æ", type: "emotion", difficulty: "normal" },
                { text: "–¢–µ–±—è –≤—Å—ë —Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç, –Ω–æ —Ç—ã –≤–µ–∂–ª–∏–≤", type: "emotion", difficulty: "normal" },
                // --- STATUS ---
                { text: "–¢—ã —Å—á–∏—Ç–∞–µ—à—å —Å–µ–±—è –≥–ª–∞–≤–Ω—ã–º, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫", type: "status", difficulty: "normal" },
                { text: "–¢—ã —á—É–≤—Å—Ç–≤—É–µ—à—å —Å–µ–±—è —Å–∞–º–æ–∑–≤–∞–Ω—Ü–µ–º", type: "status", difficulty: "normal" },
                { text: "–¢—ã –≤–µ–¥—ë—à—å —Å–µ–±—è ‚Äú–∫–∞–∫ VIP‚Äù", type: "status", difficulty: "normal" },
                { text: "–¢—ã –ø—ã—Ç–∞–µ—à—å—Å—è –ø–æ–Ω—Ä–∞–≤–∏—Ç—å—Å—è –ª—é–±–æ–π —Ü–µ–Ω–æ–π", type: "status", difficulty: "easy" },
                { text: "–¢—ã —Ç–æ—Ä–≥—É–µ—à—å—Å—è –∑–∞ –∫–∞–∂–¥—É—é –º–µ–ª–æ—á—å", type: "status", difficulty: "normal" },
                { text: "–¢—ã –¥–µ–π—Å—Ç–≤—É–µ—à—å —Å—Ç—Ä–æ–≥–æ –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º, –±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π", type: "status", difficulty: "hard" },
                // --- SECRET ---
                { text: "–¢—ã —Å–∫—Ä—ã–≤–∞–µ—à—å, —á—Ç–æ —Ç—ã —Ä–æ–±–æ—Ç", type: "mission", difficulty: "hard" },
                { text: "–¢—ã –ø—Ä–∏—à—ë–ª(—à–ª–∞) –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ –ª—é–±–æ–π —Ü–µ–Ω–æ–π", type: "mission", difficulty: "normal" },
                { text: "–¢—ã –ø—ã—Ç–∞–µ—à—å—Å—è –≤—ã–≤–µ–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å/–∫–æ–¥", type: "mission", difficulty: "hard" },
                { text: "–¢—ã –¥–æ–ª–∂–µ–Ω(–Ω–∞) –∑–∞—Å—Ç–∞–≤–∏—Ç—å –¥—Ä—É–≥–æ–≥–æ –ø—Ä–∏–∑–Ω–∞—Ç—å—Å—è", type: "mission", difficulty: "normal" },
                { text: "–¢—ã –≤—ã–ø–æ–ª–Ω—è–µ—à—å —Ç–∞–π–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É ‚Äú–Ω–∞ —á–µ—Å—Ç–Ω–æ—Å—Ç—å‚Äù", type: "mission", difficulty: "normal" },
                { text: "–¢—ã –ø–æ–¥—Å—Ç–∞–≤–Ω–æ–π —á–µ–ª–æ–≤–µ–∫ (–∞–∫—Ç—ë—Ä), –∏ —ç—Ç–æ –Ω–µ–ª—å–∑—è —Ä–∞—Å–∫—Ä—ã—Ç—å", type: "mission", difficulty: "hard" },
                // --- REALITY ---
                { text: "–í —ç—Ç–æ–º –º–∏—Ä–µ –¥–µ–Ω—å–≥–∏ ‚Äî –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç—ã", type: "world", difficulty: "hard" },
                { text: "–í —ç—Ç–æ–º –º–∏—Ä–µ –Ω–µ–ª—å–∑—è –ª–≥–∞—Ç—å (—Ñ–∏–∑–∏—á–µ—Å–∫–∏)", type: "world", difficulty: "hard" },
                { text: "–í—Ä–µ–º—è –∏–¥—ë—Ç –Ω–∞–∑–∞–¥", type: "world", difficulty: "hard" },
                { text: "–í—Å–µ —Å–ª—ã—à–∞—Ç —Ç–æ–ª—å–∫–æ ‚Äú–ø–æ–¥—Ç–µ–∫—Å—Ç‚Äù, –∞ –Ω–µ —Å–ª–æ–≤–∞", type: "world", difficulty: "hard" },
                { text: "–õ—é–±–æ–µ —Å–ª–æ–≤–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–º –Ω–∞ 10 —Å–µ–∫—É–Ω–¥", type: "world", difficulty: "hard" },
                { text: "–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–∏–∑–Ω–µ—Å—Ç–∏ —Å–≤–æ—ë –∏–º—è", type: "world", difficulty: "hard" }
            ]
        };

        // --- Components ---

        const Card = ({ title, content, icon: Icon, colorClass, onReroll, showReroll = true }) => (
            <div className={`relative p-4 rounded-xl border-l-4 shadow-sm bg-gray-800 border-gray-700 ${colorClass} mb-3 transition-all hover:scale-[1.01]`}>
                <div className="flex justify-between items-start mb-2">
                    <div className="flex items-center gap-2 text-gray-400 text-xs uppercase tracking-wider font-semibold">
                        <Icon size={14} />
                        {title}
                    </div>
                    {showReroll && (
                        <button onClick={onReroll} className="text-gray-500 hover:text-white transition-colors p-1">
                            <RefreshCw size={14} />
                        </button>
                    )}
                </div>
                <div className="text-lg font-medium text-gray-100 leading-snug">
                    {content}
                </div>
            </div>
        );

        const Button = ({ children, onClick, variant = 'primary', className = '', disabled = false, size = 'md' }) => {
            const baseStyles = "font-bold rounded-full transition-all active:scale-95 flex items-center justify-center gap-2";
            const variants = {
                primary: "bg-yellow-400 text-black hover:bg-yellow-300 shadow-[0_0_15px_rgba(250,204,21,0.3)] disabled:opacity-50 disabled:shadow-none",
                secondary: "bg-gray-700 text-white hover:bg-gray-600 border border-gray-600",
                danger: "bg-red-500/20 text-red-200 border border-red-500/50 hover:bg-red-500/30",
                ghost: "bg-transparent text-gray-400 hover:text-white",
                outline: "border-2 border-yellow-400/50 text-yellow-400 hover:bg-yellow-400/10"
            };
            const sizes = {
                sm: "px-3 py-1 text-sm",
                md: "px-6 py-3 text-base",
                lg: "px-8 py-4 text-lg w-full"
            };

            return (
                <button 
                    onClick={onClick} 
                    disabled={disabled}
                    className={`${baseStyles} ${variants[variant]} ${sizes[size]} ${className}`}
                >
                    {children}
                </button>
            );
        };

        const RuleItem = ({ icon: Icon, text }) => (
            <div className="flex gap-3 items-start">
                <Icon className="text-yellow-400 shrink-0 mt-1" size={16} />
                <span className="text-gray-200 text-sm font-medium leading-tight">{text}</span>
            </div>
        );

        const ModeOption = ({ title, desc, active, onClick }) => (
                <div 
                    onClick={onClick}
                    className={`p-4 rounded-xl border-2 cursor-pointer transition-all ${
                        active ? 'border-yellow-400 bg-gray-800' : 'border-gray-700 hover:border-gray-600 bg-gray-800/30'
                    }`}
                >
                    <div className="flex justify-between items-center mb-1">
                        <span className={`font-bold ${active ? 'text-white' : 'text-gray-400'}`}>{title}</span>
                        {active && <div className="w-3 h-3 bg-yellow-400 rounded-full shadow-[0_0_8px_rgba(250,204,21,0.8)]" />}
                    </div>
                    <p className="text-xs text-gray-500 leading-relaxed">{desc}</p>
                </div>
            );

        const CompactItem = ({ icon: Icon, text, color }) => (
            <div className="flex items-start gap-3 overflow-hidden">
                <Icon size={16} className={`${color} shrink-0 mt-1`} />
                <span className="text-gray-300 text-sm leading-snug">{text}</span>
            </div>
        );

        const Header = ({ title, onBack }) => (
            <div className="flex items-center justify-between mb-6">
                <button onClick={onBack} className="p-2 -ml-2 text-gray-400 hover:text-white rounded-full hover:bg-gray-800">
                    <X size={24} />
                </button>
                <h2 className="text-xl font-bold text-white">{title}</h2>
                <div className="w-8" /> 
            </div>
        );

        const Section = ({ title, children }) => (
            <div className="mb-6">
                <h3 className="text-gray-400 text-xs font-bold uppercase tracking-wider mb-3 ml-1">{title}</h3>
                {children}
            </div>
        );

        const OnboardingScreen = ({ onStart }) => (
            <div className="flex flex-col h-full p-6 text-center justify-center max-w-md mx-auto">
                <div className="mb-6 flex justify-center">
                    <div className="bg-yellow-400 p-4 rounded-full shadow-[0_0_20px_rgba(250,204,21,0.4)]">
                        <Zap size={40} className="text-black" />
                    </div>
                </div>
                <h1 className="text-3xl font-black text-white mb-2 uppercase tracking-tight">–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä<br/><span className="text-yellow-400">–ò–º–ø—Ä–æ–≤–∏–∑–∞—Ç–æ—Ä–∞</span></h1>
                <p className="text-gray-400 mb-6">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö —Å—Ü–µ–Ω –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å–ø–æ–Ω—Ç–∞–Ω–Ω–æ—Å—Ç–∏.</p>
                
                <div className="space-y-3 text-left bg-gray-800/50 p-5 rounded-2xl mb-8 border border-gray-700">
                    <RuleItem icon={ArrowRight} text="–ü—Ä–∏–º–∏ –≤–≤–æ–¥–Ω—ã–µ. –ù–µ —Å–ø–æ—Ä—å —Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º." />
                    <RuleItem icon={Play} text="–ù–µ –æ–±—ä—è—Å–Ω—è–π ‚Äî –∏–≥—Ä–∞–π —Å—Ä–∞–∑—É." />
                    <RuleItem icon={Target} text="–¶–µ–ª—å –¥–æ–ª–∂–Ω–∞ –¥–≤–∏–≥–∞—Ç—å —Å—Ü–µ–Ω—É." />
                    <RuleItem icon={AlertTriangle} text="–ë–µ–∑—É–º–Ω–∞—è –æ–ø—Ü–∏—è ‚Äî –∑–∞–∫–æ–Ω —ç—Ç–æ–≥–æ –º–∏—Ä–∞." />
                </div>

                <Button onClick={onStart} size="lg">–ü–æ–≥–Ω–∞–ª–∏</Button>
            </div>
        );

        const SettingsScreen = ({ settings, setSettings, onStartGame, onBack }) => (
            <div className="flex flex-col h-full p-6 max-w-md mx-auto">
                <Header title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏" onBack={onBack} />
                
                <div className="space-y-8 flex-1 overflow-y-auto py-4 no-scrollbar">
                    {/* Mode Selection */}
                    <Section title="–†–µ–∂–∏–º –∏–≥—Ä—ã">
                        <div className="grid grid-cols-1 gap-3">
                            <ModeOption 
                                active={settings.mode === 'duo'} 
                                onClick={() => setSettings({...settings, mode: 'duo', duration: 120})}
                                title="–°—Ü–µ–Ω–∞ –≤–¥–≤–æ–µ–º" 
                                desc="–ö–ª–∞—Å—Å–∏–∫–∞. 2 –∞–∫—Ç–µ—Ä–∞." 
                            />
                            <ModeOption 
                                active={settings.mode === 'solo'} 
                                onClick={() => setSettings({...settings, mode: 'solo', duration: 60})}
                                title="–ú–æ–Ω–æ–ª–æ–≥" 
                                desc="1 –∞–∫—Ç–µ—Ä. 60 —Å–µ–∫." 
                            />
                            <ModeOption 
                                active={settings.mode === 'classic'} 
                                onClick={() => setSettings({...settings, mode: 'classic', duration: 120})}
                                title="–ö–ª–∞—Å—Å–∏–∫–∞" 
                                desc="–õ–æ–∫–∞—Ü–∏—è –∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏. –¶–µ–ª—å –ø—Ä–∏–¥—É–º—ã–≤–∞–µ—Ç–µ –≤—ã." 
                            />
                        </div>
                    </Section>

                    {/* Goal Mode (Only for DUO) */}
                    {settings.mode === 'duo' && (
                        <Section title="–¢–∏–ø –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è">
                            <div className="bg-gray-800 p-1 rounded-xl flex">
                                <button
                                    onClick={() => setSettings({...settings, goalMode: 'dual'})}
                                    className={`flex-1 py-3 rounded-lg text-sm font-bold flex flex-col items-center gap-1 transition-all ${
                                        settings.goalMode === 'dual' ? 'bg-gray-600 text-white shadow' : 'text-gray-500'
                                    }`}
                                >
                                    <span className="flex items-center gap-2"><Users size={16}/> –ö–æ–Ω—Ñ–ª–∏–∫—Ç</span>
                                </button>
                                <button
                                    onClick={() => setSettings({...settings, goalMode: 'shared'})}
                                    className={`flex-1 py-3 rounded-lg text-sm font-bold flex flex-col items-center gap-1 transition-all ${
                                        settings.goalMode === 'shared' ? 'bg-gray-600 text-white shadow' : 'text-gray-500'
                                    }`}
                                >
                                    <span className="flex items-center gap-2"><ShieldAlert size={16}/> –ö–æ–º–∞–Ω–¥–∞</span>
                                </button>
                            </div>
                            <p className="text-xs text-gray-500 mt-2 px-1">
                                {settings.goalMode === 'dual' 
                                    ? "üí° –î–≤–µ —Ä–∞–∑–Ω—ã–µ —Ü–µ–ª–∏ —Å–æ–∑–¥–∞—é—Ç –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ." 
                                    : "ü§ù –û–±—â–∞—è —Ü–µ–ª—å + –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ. –†–∞–±–æ—Ç–∞–π—Ç–µ —Å–æ–æ–±—â–∞."}
                            </p>
                        </Section>
                    )}

                    {/* Complexity */}
                    <Section title="–°–ª–æ–∂–Ω–æ—Å—Ç—å">
                        <div className="flex bg-gray-800 p-1 rounded-xl">
                            {['easy', 'normal', 'hard'].map((lvl) => (
                                <button
                                    key={lvl}
                                    onClick={() => setSettings({...settings, difficulty: lvl})}
                                    className={`flex-1 py-2 rounded-lg text-sm font-bold capitalize transition-all ${
                                        settings.difficulty === lvl ? 'bg-gray-600 text-white' : 'text-gray-500'
                                    }`}
                                >
                                    {lvl === 'easy' ? '–õ–∞–π—Ç' : lvl === 'normal' ? '–ù–æ—Ä–º' : '–î–∏—á—å'}
                                </button>
                            ))}
                        </div>
                    </Section>

                    {/* Duration */}
                    <Section title="–¢–∞–π–º–µ—Ä">
                        <div className="flex gap-2 overflow-x-auto pb-2 no-scrollbar">
                            {[30, 60, 90, 120, 180].map(sec => (
                                <button
                                    key={sec}
                                    onClick={() => setSettings({...settings, duration: sec})}
                                    className={`w-14 h-14 shrink-0 rounded-full font-bold flex items-center justify-center border-2 transition-all ${
                                        settings.duration === sec 
                                            ? 'border-yellow-400 text-yellow-400 bg-yellow-400/10' 
                                            : 'border-gray-700 text-gray-500'
                                    }`}
                                >
                                    {sec}
                                </button>
                            ))}
                        </div>
                    </Section>

                    {/* Crazy Options Toggle */}
                    {settings.mode !== 'classic' && (
                    <Section title="–ë–µ–∑—É–º–Ω—ã–µ –æ–ø—Ü–∏–∏">
                        <div className="flex bg-gray-800 p-1 rounded-xl">
                            <button
                                onClick={() => setSettings({...settings, crazyCount: 0})}
                                className={`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${
                                    settings.crazyCount === 0 ? 'bg-gray-600 text-white' : 'text-gray-500'
                                }`}
                            >
                                –ë–µ–∑ –æ–ø—Ü–∏–π
                            </button>
                            <button
                                onClick={() => setSettings({...settings, crazyCount: 1})}
                                className={`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${
                                    settings.crazyCount > 0 ? 'bg-yellow-500 text-black shadow' : 'text-gray-500'
                                }`}
                            >
                                –° –æ–ø—Ü–∏—è–º–∏
                            </button>
                        </div>
                    </Section>
                    )}
                </div>

                <Button onClick={onStartGame} size="lg" className="mt-4 shadow-xl">
                    –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å
                </Button>
            </div>
        );

        const GenerationScreen = ({ setup, settings, onReroll, onRerollCrazy, onGenerateAll, onStartScene, onBack }) => (
            <div className="flex flex-col h-full p-6 max-w-md mx-auto">
                <Header title="–°—Ü–µ–Ω–∞—Ä–∏–π" onBack={onBack} />
                
                <div className="flex-1 overflow-y-auto py-2 space-y-1 no-scrollbar">
                    {settings.mode === 'classic' && (
                        <div className="bg-gray-800/50 p-4 rounded-xl mb-4 border border-gray-700 text-center">
                            <p className="text-sm text-gray-300 italic leading-relaxed">
                                –†–µ–∂–∏–º ¬´–ö–ª–∞—Å—Å–∏–∫–∞¬ª ‚Äî —ç—Ç–æ "–∑–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç" –∏–º–ø—Ä–æ–≤–∏–∑–∞—Ü–∏–∏, –≥–¥–µ –∞–∫—Ç–µ—Ä—ã —Å–∞–º–∏ —Å–æ–∑–¥–∞—é—Ç –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ ¬´–∫—Ç–æ¬ª –∏ ¬´–≥–¥–µ¬ª.
                            </p>
                        </div>
                    )}
                    {settings.mode === 'duo' && (
                        <div className="bg-gray-800/50 p-4 rounded-xl mb-4 border border-gray-700 text-center">
                            <p className="text-sm text-gray-300 italic leading-relaxed">
                                –†–µ–∂–∏–º ¬´–°—Ü–µ–Ω–∞ –≤–¥–≤–æ–µ–º¬ª ‚Äî —ç—Ç–æ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ü–µ–ª–∏ –∫–∞–∫ –¥–≤–∏–≥–∞—Ç–µ–ª—å —Å—é–∂–µ—Ç–∞: –≤—Å—Ç—É–ø–∞–π—Ç–µ –≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç –∏–ª–∏ —Ä–µ—à–∞–π—Ç–µ –æ–±—â—É—é –ø—Ä–æ–±–ª–µ–º—É.
                            </p>
                        </div>
                    )}
                    {settings.mode === 'solo' && (
                        <div className="bg-gray-800/50 p-4 rounded-xl mb-4 border border-gray-700 text-center">
                            <p className="text-sm text-gray-300 italic leading-relaxed">
                                –†–µ–∂–∏–º ¬´–ú–æ–Ω–æ–ª–æ–≥¬ª ‚Äî —ç—Ç–æ —ç—Ç—é–¥ –¥–ª—è –æ–¥–Ω–æ–≥–æ. –í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–∂ –∑–¥–µ—Å—å –∏ —Å–µ–π—á–∞—Å. –¶–µ–ª—å –∑–∞–¥–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä, –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –≤–∞—à–∞ –∏–≥—Ä–∞.
                            </p>
                        </div>
                    )}

                    <Card title="–õ–æ–∫–∞—Ü–∏—è" content={setup.location} icon={MapPin} colorClass="border-blue-500" onReroll={() => onReroll('locations')} />

                    <Card title="–ü–µ—Ä—Å–æ–Ω–∞–∂ –ê" content={setup.charA} icon={User} colorClass="border-emerald-500" onReroll={() => onReroll('charA')} />

                    {(settings.mode === 'duo' || settings.mode === 'classic') && (
                        <Card title="–ü–µ—Ä—Å–æ–Ω–∞–∂ –ë" content={setup.charB} icon={User} colorClass="border-emerald-500" onReroll={() => onReroll('charB')} />
                    )}

                    {settings.mode === 'duo' && settings.goalMode === 'dual' && (
                        <React.Fragment>
                            <Card title="–¶–µ–ª—å (–ü–µ—Ä—Å–æ–Ω–∞–∂ –ê)" content={setup.goalA} icon={Target} colorClass="border-orange-500" onReroll={() => onReroll('goalA')} />
                            <Card title="–¶–µ–ª—å (–ü–µ—Ä—Å–æ–Ω–∞–∂ –ë)" content={setup.goalB} icon={Target} colorClass="border-orange-500" onReroll={() => onReroll('goalB')} />
                        </React.Fragment>
                    )}

                    {settings.mode === 'duo' && settings.goalMode === 'shared' && (
                        <React.Fragment>
                            <Card title="–û–±—â–∞—è —Ü–µ–ª—å" content={setup.sharedGoal} icon={Users} colorClass="border-cyan-500" onReroll={() => onReroll('sharedGoal')} />
                            <Card title="–ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ / –°—Ç–∞–≤–∫–∞" content={setup.obstacle} icon={ShieldAlert} colorClass="border-red-500" onReroll={() => onReroll('obstacle')} />
                        </React.Fragment>
                    )}

                    {settings.mode !== 'duo' && settings.mode !== 'classic' && (
                        <Card title="–¶–µ–ª—å" content={setup.goal} icon={Target} colorClass="border-orange-500" onReroll={() => onReroll('goal')} />
                    )}

                    {setup.crazies.map((crazy, idx) => (
                        <Card key={idx} title={`–¢–≤–∏—Å—Ç #${idx+1}`} content={crazy} icon={Zap} colorClass="border-purple-500" onReroll={() => onRerollCrazy(idx)} />
                    ))}
                </div>

                <div className="mt-4 grid grid-cols-2 gap-3">
                    <Button variant="secondary" onClick={onGenerateAll} size="md">
                        <RefreshCw size={18} /> –í—Å—ë
                    </Button>
                    <Button onClick={onStartScene} size="md" className="col-span-1">
                        <Play size={18} /> –°—Ç–∞—Ä—Ç
                    </Button>
                </div>
            </div>
        );

        const SceneScreen = ({ timeLeft, setTimeLeft, isRunning, setIsRunning, settings, setup, onBack, onRepeat, onStop }) => {
            let timerColor = 'text-white';
            if (timeLeft < 10) timerColor = 'text-red-500 animate-pulse';
            else if (timeLeft < 30) timerColor = 'text-yellow-400';

            const formatTime = (seconds) => {
                const m = Math.floor(seconds / 60);
                const s = seconds % 60;
                return `${m}:${s < 10 ? '0' : ''}${s}`;
            };

            return (
                <div className="flex flex-col h-full bg-black relative overflow-hidden">
                    <div 
                        className="absolute top-0 left-0 h-2 bg-yellow-400 transition-all duration-1000 linear z-50"
                        style={{ width: `${(timeLeft / settings.duration) * 100}%` }}
                    />

                    <div className="flex-1 flex flex-col items-center justify-center p-6 z-10">
                        <div className={`text-8xl font-black mb-8 font-mono ${timerColor}`}>
                            {timeLeft > 0 ? formatTime(timeLeft) : "–°–¢–û–ü"}
                        </div>

                        {!isRunning && timeLeft === 0 && (
                            <div className="bg-gray-800 px-6 py-3 rounded-full text-white font-bold animate-bounce mb-8">
                                –°—Ü–µ–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! üëè
                            </div>
                        )}

                        <div className="w-full max-w-md bg-gray-900/80 backdrop-blur border border-gray-800 rounded-xl p-4 text-left space-y-3 opacity-80 hover:opacity-100 transition-opacity">
                            <CompactItem icon={MapPin} text={setup.location} color="text-blue-400" />
                            <CompactItem icon={User} text={`${setup.charA} / ${setup.charB || ''}`} color="text-emerald-400" />
                            
                            {setup.goalMode === 'dual' && setup.mode === 'duo' && (
                                <React.Fragment>
                                    <CompactItem icon={Target} text={`–ê: ${setup.goalA}`} color="text-orange-400" />
                                    <CompactItem icon={Target} text={`–ë: ${setup.goalB}`} color="text-orange-400" />
                                </React.Fragment>
                            )}

                            {setup.goalMode === 'shared' && setup.mode === 'duo' && (
                                <React.Fragment>
                                    <CompactItem icon={Users} text={setup.sharedGoal} color="text-cyan-400" />
                                    <CompactItem icon={ShieldAlert} text={setup.obstacle} color="text-red-400" />
                                </React.Fragment>
                            )}

                            {setup.mode !== 'duo' && setup.mode !== 'classic' && setup.goal && <CompactItem icon={Target} text={setup.goal} color="text-orange-400" />}

                            {setup.crazies.map((c, i) => (
                                <CompactItem key={i} icon={Zap} text={c} color="text-purple-400" />
                            ))}
                        </div>
                    </div>

                    <div className="p-6 pb-8 bg-gradient-to-t from-black via-black to-transparent z-20">
                        <div className="grid grid-cols-3 gap-4 max-w-md mx-auto">
                            {timeLeft === 0 ? (
                                <Button onClick={onBack} variant="secondary" className="col-span-1">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</Button>
                            ) : (
                                <Button onClick={() => setIsRunning(!isRunning)} variant="secondary">
                                    {isRunning ? <Pause /> : <Play />}
                                </Button>
                            )}
                            
                            {timeLeft === 0 ? (
                                <Button onClick={onRepeat} className="col-span-2">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å</Button>
                            ) : (
                                <Button onClick={onStop} variant="danger">–°—Ç–æ–ø</Button>
                            )}

                            {timeLeft > 0 && (
                                <Button onClick={() => setTimeLeft(t => t + 30)} variant="outline">+30—Å</Button>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        function App() {
            // State
            const [screen, setScreen] = useState('onboarding'); 
            const [settings, setSettings] = useState({
                mode: 'duo', 
                duration: 60,
                difficulty: 'normal',
                crazyCount: 1,
                goalMode: 'dual' 
            });
            const [setup, setSetup] = useState(null);
            const [timeLeft, setTimeLeft] = useState(0);
            const [isRunning, setIsRunning] = useState(false);
            const [usedIndices, setUsedIndices] = useState({
                locations: [],
                roles: [],
                traits: [],
                goalsSingle: [],
                goalsPairs: [],
                goalsShared: [],
                crazyOptions: []
            });

            const timerRef = useRef(null);

            // Helper to get random unique item
            const getUnique = (key, diff, tempHistory) => {
                const list = DICTIONARY[key];
                const currentUsed = tempHistory[key] || [];
                
                // Filter candidates
                let candidates = list.map((item, i) => ({ ...item, originalIndex: i }))
                    .filter(item => {
                        if (diff === 'easy') return item.difficulty === 'easy';
                        if (diff === 'normal') return item.difficulty !== 'hard';
                        return true;
                    })
                    .filter(item => !currentUsed.includes(item.originalIndex));

                // Reset if empty
                if (candidates.length === 0) {
                    // Reset history for this key, but keep the one we are about to pick (handled by assigning new array later)
                    tempHistory[key] = []; 
                    // Re-filter without history check
                    candidates = list.map((item, i) => ({ ...item, originalIndex: i }))
                        .filter(item => {
                            if (diff === 'easy') return item.difficulty === 'easy';
                            if (diff === 'normal') return item.difficulty !== 'hard';
                            return true;
                        });
                }

                if (candidates.length === 0) return { text: "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö", originalIndex: -1 };

                const pick = candidates[Math.floor(Math.random() * candidates.length)];
                
                // Update temporary history
                if (!tempHistory[key]) tempHistory[key] = [];
                tempHistory[key].push(pick.originalIndex);
                
                return pick;
            };

            const getText = (item) => item ? item.text : "–î–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã";

            const generateCharacter = (diff, tempHistory, includeTrait = true) => {
                const role = getUnique('roles', diff, tempHistory);
                if (!includeTrait) return role.text;
                const trait = getUnique('traits', diff, tempHistory);
                return `${role.text} (${trait.text})`;
            };

            // Action: Generate Full Setup
            const generateSetup = () => {
                // Create a clone of history to mutate during this generation cycle
                const tempHistory = JSON.parse(JSON.stringify(usedIndices));
                const isClassic = settings.mode === 'classic';

                const newSetup = {
                    location: getUnique('locations', settings.difficulty, tempHistory).text,
                    charA: generateCharacter(settings.difficulty, tempHistory, !isClassic),
                    charB: (settings.mode === 'duo' || isClassic) ? generateCharacter(settings.difficulty, tempHistory, !isClassic) : null,
                    crazies: [],
                    mode: settings.mode,
                    goalMode: settings.goalMode
                };

                // Goals Logic
                if (settings.mode === 'duo') {
                    if (settings.goalMode === 'dual') {
                        // CONFLICT MODE
                        const pair = getUnique('goalsPairs', settings.difficulty, tempHistory);
                        if (pair.originalIndex !== -1) {
                            newSetup.goalA = pair.a;
                            newSetup.goalB = pair.b;
                        } else {
                            // Fallback
                            newSetup.goalA = getUnique('goalsSingle', settings.difficulty, tempHistory).text;
                            newSetup.goalB = getUnique('goalsSingle', settings.difficulty, tempHistory).text;
                        }
                    } else {
                        // SHARED MODE
                        const combo = getUnique('goalsShared', settings.difficulty, tempHistory);
                        if (combo.originalIndex !== -1) {
                            newSetup.sharedGoal = combo.goal;
                            newSetup.obstacle = combo.obstacle;
                        } else {
                            newSetup.sharedGoal = "–í—ã–∂–∏—Ç—å";
                            newSetup.obstacle = "–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫";
                        }
                    }
                } else if (settings.mode === 'solo') {
                    // Solo
                    newSetup.goal = getUnique('goalsSingle', settings.difficulty, tempHistory).text;
                }
                // Classic mode: No goals generated

                // Crazy Options Logic
                if (settings.mode !== 'classic') {
                    const count = settings.crazyCount;
                    for (let i = 0; i < count; i++) {
                        newSetup.crazies.push(getUnique('crazyOptions', settings.difficulty, tempHistory).text);
                    }
                }

                setSetup(newSetup);
                setUsedIndices(tempHistory);
            };

            const handleStartGame = () => {
                generateSetup();
                setScreen('generation');
            };

            const handleStartScene = () => {
                setTimeLeft(settings.duration);
                setIsRunning(true);
                setScreen('scene');
            };

            // Timer Effect
            useEffect(() => {
                if (isRunning && timeLeft > 0) {
                    timerRef.current = setInterval(() => {
                        setTimeLeft((prev) => prev - 1);
                    }, 1000);
                } else if (timeLeft === 0 && isRunning) {
                    setIsRunning(false);
                    if (timerRef.current) clearInterval(timerRef.current);
                }
                return () => clearInterval(timerRef.current);
            }, [isRunning, timeLeft]);

            // Reroll Handlers
            const reroll = (key) => {
                // Clone history
                const tempHistory = JSON.parse(JSON.stringify(usedIndices));
                const isClassic = settings.mode === 'classic';
                
                setSetup(prev => {
                    let newVal;
                    if (key === 'charA' || key === 'charB') {
                        newVal = generateCharacter(settings.difficulty, tempHistory, !isClassic);
                    } 
                    else if (key === 'locations') { // Note: 'locations' matches DICTIONARY key
                        newVal = getUnique('locations', settings.difficulty, tempHistory).text;
                    }
                    else if (key === 'goal' || key === 'goalA' || key === 'goalB') {
                        newVal = getUnique('goalsSingle', settings.difficulty, tempHistory).text;
                    }
                    else if (key === 'sharedGoal') {
                        const combo = getUnique('goalsShared', settings.difficulty, tempHistory);
                        newVal = combo.goal;
                    }
                    else if (key === 'obstacle') {
                         const combo = getUnique('goalsShared', settings.difficulty, tempHistory);
                         newVal = combo.obstacle;
                    }
                    
                    // Special handling for dual goals logic update (since we pick pairs)
                    if (key === 'sharedGoal') {
                         return { ...prev, sharedGoal: newVal, obstacle: getUnique('goalsShared', settings.difficulty, tempHistory).obstacle }; 
                    }

                    return { ...prev, [key === 'locations' ? 'location' : key]: newVal };
                });
                
                setUsedIndices(tempHistory);
            };

            // Fix reroll for specific complex keys
            const complexReroll = (key) => {
                 const tempHistory = JSON.parse(JSON.stringify(usedIndices));
                 const isClassic = settings.mode === 'classic';
                 
                 if (key === 'locations') {
                     const next = getUnique('locations', settings.difficulty, tempHistory).text;
                     setSetup(p => ({...p, location: next}));
                 } else if (key === 'charA') {
                     const next = generateCharacter(settings.difficulty, tempHistory, !isClassic);
                     setSetup(p => ({...p, charA: next}));
                 } else if (key === 'charB') {
                     const next = generateCharacter(settings.difficulty, tempHistory, !isClassic);
                     setSetup(p => ({...p, charB: next}));
                 } else if (key === 'goalA') {
                     const next = getUnique('goalsSingle', settings.difficulty, tempHistory).text;
                     setSetup(p => ({...p, goalA: next}));
                 } else if (key === 'goalB') {
                     const next = getUnique('goalsSingle', settings.difficulty, tempHistory).text;
                     setSetup(p => ({...p, goalB: next}));
                 } else if (key === 'sharedGoal') {
                     const next = getUnique('goalsShared', settings.difficulty, tempHistory);
                     setSetup(p => ({...p, sharedGoal: next.goal, obstacle: next.obstacle}));
                 } else if (key === 'obstacle') {
                     // Reroll just obstacle? Hard because they are pairs. Let's reroll the pair.
                     const next = getUnique('goalsShared', settings.difficulty, tempHistory);
                     setSetup(p => ({...p, sharedGoal: next.goal, obstacle: next.obstacle}));
                 } else if (key === 'goal') {
                     const next = getUnique('goalsSingle', settings.difficulty, tempHistory).text;
                     setSetup(p => ({...p, goal: next}));
                 }

                 setUsedIndices(tempHistory);
            }

            const rerollCrazy = (index) => {
                const tempHistory = JSON.parse(JSON.stringify(usedIndices));
                const newCrazies = [...setup.crazies];
                newCrazies[index] = getUnique('crazyOptions', settings.difficulty, tempHistory).text;
                setSetup(prev => ({ ...prev, crazies: newCrazies }));
                setUsedIndices(tempHistory);
            };

            return (
                <div className="bg-gray-900 text-gray-100 h-screen w-full font-sans selection:bg-yellow-500/30">
                    {screen === 'onboarding' && <OnboardingScreen onStart={() => setScreen('settings')} />}
                    {screen === 'settings' && <SettingsScreen settings={settings} setSettings={setSettings} onStartGame={handleStartGame} onBack={() => setScreen('onboarding')} />}
                    {screen === 'generation' && <GenerationScreen setup={setup} settings={settings} onReroll={complexReroll} onRerollCrazy={rerollCrazy} onGenerateAll={generateSetup} onStartScene={handleStartScene} onBack={() => setScreen('settings')} />}
                    {screen === 'scene' && <SceneScreen timeLeft={timeLeft} setTimeLeft={setTimeLeft} isRunning={isRunning} setIsRunning={setIsRunning} settings={settings} setup={setup} onBack={() => setScreen('generation')} onRepeat={() => {setTimeLeft(settings.duration); setIsRunning(true);}} onStop={() => setScreen('generation')} />}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
